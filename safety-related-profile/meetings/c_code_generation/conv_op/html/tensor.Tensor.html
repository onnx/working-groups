<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" href="icofont.min.css">
<title>Module tensor.Tensor</title>
</head>
<body>
<header><a href="index.html">index</a> — <code>library <a href="tensor.index.html">tensor</a></code> — <code>module Tensor</code></header>
<div class="doc">
<div class="doc">
<p>Formalization of Tensor</p>
</div>
<pre class="src">
<span class="keyword">module</span> <span class="scope">Tensor</span><a href="tensor.proof.html#Tensor" title="Valid (8 goals)" class="icon valid icofont-check"></a>
  <span class="keyword">use</span> int.<a title="int.Int" href="https://www.why3.org/stdlib/int.html#Int_">Int</a>
  <span class="keyword">use</span> map.<a title="map.Map" href="https://www.why3.org/stdlib/map.html#Map_">Map</a>
  <span class="keyword">use</span> list.<a title="list.List" href="https://www.why3.org/stdlib/list.html#List_">List</a>
  <span class="keyword">use</span> <a title="tensor.Range" href="tensor.Range.html">Range</a>

  <span class="keyword">type</span> <a id="data">data</a> &#39;a = <a title="map.Map.map" href="https://www.why3.org/stdlib/map.html#map_9">map</a> (<a title="list.List.list" href="https://www.why3.org/stdlib/list.html#list_8">list</a> int) &#39;a

  <span class="keyword">type</span> <a id="tensor">tensor</a><a href="tensor.proof.html#Tensor.tensor" title="Valid (one goal)" class="icon valid icofont-check"></a> &#39;a = {
    <a id="dims">dims</a> : <a title="list.List.list" href="https://www.why3.org/stdlib/list.html#list_8">list</a> int ;
    <a id="data">data</a> : <a title="tensor.Tensor.data" href="#data">data</a> &#39;a ;
    <a id="background">background</a> : &#39;a ; <span class="comment">(* default value, or value for 0-dimensions tensor *)</span>
  }
  <span class="keyword">invariant</span> { <a title="tensor.Range.positive" href="tensor.Range.html#positive">positive</a> dims }
  <span class="keyword">invariant</span> { <span class="keyword">forall</span> k. <a title="tensor.Range.valid" href="tensor.Range.html#valid">valid</a> k dims \/ data k = background }
  <span class="section level1"><span class="comment">{</span><span class="attribute section-toggle">proof</span><span class="comment section-text active">…</span><span class="comment">}</span><span class="section-text">
  <span class="keyword">by</span> <span class="keyword">let</span> d = <span class="keyword">any</span> &#39;a <span class="keyword">in</span> { dims = <a title="list.List.Nil" href="https://www.why3.org/stdlib/list.html#Nil_8">Nil</a> ; data = (<span class="keyword">fun</span> _ -&gt; d) ; background = d }
  <span class="comment">{</span><span class="attribute section-toggle">qed</span><span class="comment">}</span></span></span>

  <span class="keyword">meta</span> coercion <span class="keyword">function</span> <a title="tensor.Tensor.dims" href="#dims">dims</a>
  <span class="keyword">meta</span> coercion <span class="keyword">function</span> <a title="tensor.Tensor.data" href="#data">data</a>
</pre>
<div class="doc">
<p>Tensor with the same dimensions</p>
</div>
<pre class="src">
  <span class="keyword">predicate</span> (<a id="infix%20~">~</a>) (a : <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;a) (b : <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;b) = a.<a title="tensor.Tensor.dims" href="#dims">dims</a> = b.<a title="tensor.Tensor.dims" href="#dims">dims</a>
</pre>
<div class="doc">
<p>Tensor with the same dimensions and background value</p>
</div>
<pre class="src">
  <span class="keyword">predicate</span> (<a id="infix%20~%3D">~=</a>) (a : <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;a) (b : <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;a) =
    a <a title="tensor.Tensor.(~)" href="#infix%20~">~</a> b /\ a.<a title="tensor.Tensor.background" href="#background">background</a> = b.<a title="tensor.Tensor.background" href="#background">background</a>
</pre>
<div class="doc">
<p>Equal tensors</p>
</div>
<pre class="src">
  <span class="keyword">predicate</span> (<a id="infix%20%3D%3D">==</a>) (a b : <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;a) =
    a <a title="tensor.Tensor.(~=)" href="#infix%20~%3D">~=</a> b /\ <span class="keyword">forall</span> k. <a title="tensor.Range.valid" href="tensor.Range.html#valid">valid</a> k a.<a title="tensor.Tensor.dims" href="#dims">dims</a> -&gt; a.<a title="tensor.Tensor.data" href="#data">data</a> k = b.<a title="tensor.Tensor.data" href="#data">data</a> k
</pre>
<div class="doc">
<p>Extensionality</p>
</div>
<pre class="src">
  <span class="keyword">lemma</span> <a id="exteq">exteq</a><a href="tensor.proof.html#Tensor.exteq" title="Valid (3 goals)" class="icon valid icofont-check"></a>: <span class="keyword">forall</span> a b : <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;a. a <a title="tensor.Tensor.(==)" href="#infix%20%3D%3D">==</a> b &lt;-&gt; a = b
  <span class="section level1"><span class="comment">{</span><span class="attribute section-toggle">proof</span><span class="comment section-text active">…</span><span class="comment">}</span><span class="section-text"> <span class="keyword">by</span> <a title="tensor.Tensor.tensor'eq" href="#tensor%27eq">tensor&#39;eq</a> a b <span class="comment">{</span><span class="attribute section-toggle">qed</span><span class="comment">}</span></span></span>
</pre>
<div class="doc">
<p>Scalar Tensor</p>
</div>
<pre class="src">
  <span class="keyword">let</span> <span class="keyword">ghost</span> <span class="keyword">function</span> <a id="scalar">scalar</a><a href="tensor.proof.html#Tensor.scalar" title="Valid (one goal)" class="icon valid icofont-check"></a> (v : &#39;a) : <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;a
    <span class="keyword">ensures</span> { result.<a title="tensor.Tensor.dims" href="#dims">dims</a> = <a title="list.List.Nil" href="https://www.why3.org/stdlib/list.html#Nil_8">Nil</a> }
    <span class="keyword">ensures</span> { result.<a title="tensor.Tensor.background" href="#background">background</a> = v }
    <span class="keyword">ensures</span> { <span class="keyword">forall</span> k. result k = v }
    <span class="section level1"><span class="comment">{</span><span class="attribute section-toggle">proof</span><span class="comment section-text active">…</span><span class="comment">}</span><span class="section-text">
    = { <a title="tensor.Tensor.dims" href="#dims">dims</a> = <a title="list.List.Nil" href="https://www.why3.org/stdlib/list.html#Nil_8">Nil</a> ; <a title="tensor.Tensor.data" href="#data">data</a> = (<span class="keyword">fun</span> _ -&gt; v) ; <a title="tensor.Tensor.background" href="#background">background</a> = v }
    <span class="comment">{</span><span class="attribute section-toggle">qed</span><span class="comment">}</span></span></span>
</pre>
<div class="doc">
<p>Null Tensor</p>
</div>
<pre class="src">
  <span class="keyword">let</span> <span class="keyword">ghost</span> <span class="keyword">function</span> <a id="zero">zero</a><a href="tensor.proof.html#Tensor.zero" title="Valid (one goal)" class="icon valid icofont-check"></a> (e : &#39;a) (ds : <a title="list.List.list" href="https://www.why3.org/stdlib/list.html#list_8">list</a> int) : <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;a
    <span class="keyword">requires</span> { <a title="tensor.Range.positive" href="tensor.Range.html#positive">positive</a> ds }
    <span class="keyword">ensures</span> { result.<a title="tensor.Tensor.dims" href="#dims">dims</a> = ds }
    <span class="keyword">ensures</span> { result.<a title="tensor.Tensor.background" href="#background">background</a> = e }
    <span class="keyword">ensures</span> { <span class="keyword">forall</span> k. result k = e }
    <span class="section level1"><span class="comment">{</span><span class="attribute section-toggle">proof</span><span class="comment section-text active">…</span><span class="comment">}</span><span class="section-text">
    = { <a title="tensor.Tensor.dims" href="#dims">dims</a> = ds ; <a title="tensor.Tensor.data" href="#data">data</a> = (<span class="keyword">fun</span> _ -&gt; e) ; <a title="tensor.Tensor.background" href="#background">background</a> = e }
    <span class="comment">{</span><span class="attribute section-toggle">qed</span><span class="comment">}</span></span></span>
</pre>
<div class="doc">
<p>Constant Tensor</p>
</div>
<pre class="src">
  <span class="keyword">let</span> <span class="keyword">ghost</span> <span class="keyword">function</span> <a id="const">const</a><a href="tensor.proof.html#Tensor.const" title="Valid (one goal)" class="icon valid icofont-check"></a> (v : &#39;a) (bg : &#39;a) (ds : <a title="list.List.list" href="https://www.why3.org/stdlib/list.html#list_8">list</a> int): <a title="tensor.Tensor.tensor" href="#tensor">tensor</a> &#39;a
    <span class="keyword">ensures</span> { result.<a title="tensor.Tensor.dims" href="#dims">dims</a> = ds }
    <span class="keyword">requires</span> { <a title="tensor.Range.positive" href="tensor.Range.html#positive">positive</a> ds }
    <span class="keyword">ensures</span> { result.<a title="tensor.Tensor.background" href="#background">background</a> = bg }
    <span class="keyword">ensures</span> { <span class="keyword">forall</span> k. <a title="tensor.Range.valid" href="tensor.Range.html#valid">valid</a> k ds -&gt; result k = v }
    <span class="section level1"><span class="comment">{</span><span class="attribute section-toggle">proof</span><span class="comment section-text active">…</span><span class="comment">}</span><span class="section-text">
    = { <a title="tensor.Tensor.dims" href="#dims">dims</a> = ds ; <a title="tensor.Tensor.data" href="#data">data</a> = <span class="keyword">pure</span> { <span class="keyword">fun</span> k -&gt; <span class="keyword">if</span> <a title="tensor.Range.valid" href="tensor.Range.html#valid">valid</a> k ds <span class="keyword">then</span> v <span class="keyword">else</span> bg } ; <a title="tensor.Tensor.background" href="#background">background</a> = bg }
    <span class="comment">{</span><span class="attribute section-toggle">qed</span><span class="comment">}</span></span></span>
</pre>
<div class="doc">
<p>Constant &amp; Null</p>
</div>
<pre class="src">
  <span class="keyword">goal</span> <a id="zero_is_const">zero_is_const</a><a href="tensor.proof.html#Tensor.zero_is_const" title="Valid (one goal)" class="icon valid icofont-check"></a>: <span class="keyword">forall</span> e : &#39;a, ds. <a title="tensor.Range.positive" href="tensor.Range.html#positive">positive</a> ds -&gt; <a title="tensor.Tensor.zero" href="#zero">zero</a> e ds <a title="tensor.Tensor.(==)" href="#infix%20%3D%3D">==</a> <a title="tensor.Tensor.const" href="#const">const</a> e e ds

<span class="keyword">end</span>
</pre>
<script type="text/javascript" src="script.js"></script>
</body>
</html>

(**
    Specification of Abs operation on tensors.
 *)

module Abs
  use int.Int
  use map.Map
  use utils.Same
  use tensor.Shape
  use tensor.Tensor

  let function abs (a : tensor 'a) : tensor 'a =
  {
    shape = a.shape ;
    value = fun i -> if a.value[i] < 0 then -a.value[i] else a.value[i] ;
  }

end